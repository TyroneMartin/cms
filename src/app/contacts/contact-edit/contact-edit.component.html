<div class="row">
  <div class="col-md-7">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">{{ isEditMode ? 'Edit Contact' : 'New Contact' }}</h5>
      </div>
      <div class="card-body">
        <form #contactForm="ngForm" (ngSubmit)="onSave()">
          <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input 
              type="text" 
              class="form-control" 
              id="name" 
              name="name"
              [(ngModel)]="contact!.name"
              required>
          </div>
          
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input 
              type="email" 
              class="form-control" 
              id="email" 
              name="email"
              [(ngModel)]="contact!.email"
              required>
          </div>
          
          <div class="mb-3">
            <label for="phone" class="form-label">Phone</label>
            <input 
              type="tel" 
              class="form-control" 
              id="phone" 
              name="phone"
              [(ngModel)]="contact!.phone">
          </div>
          
          <div class="mb-3">
            <label for="imageUrl" class="form-label">Image URL</label>
            <input 
              type="url" 
              class="form-control" 
              id="imageUrl" 
              name="imageUrl"
              [(ngModel)]="contact!.imageUrl">
          </div>
          
          <div class="mb-3">
            <label class="form-label">Group Contacts</label>
            

            <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
              {{ errorMessage }}
            </div>
            

            <div 
              class="border rounded p-3 mb-3 bg-light"
              style="min-height: 120px;"
              cdkDropList
              id="group-contacts"
              [cdkDropListData]="groupContacts"
              (cdkDropListDropped)="onDrop($event)"
              [cdkDropListEnterPredicate]="canDropPredicate">
              
              <p class="text-muted mb-2" *ngIf="groupContacts.length === 0">
                Drag contacts here to add them to the group
              </p>
              
              <div 
                *ngFor="let groupContact of groupContacts" 
                class="d-flex align-items-center justify-content-between border rounded p-2 mb-2 bg-white"
                cdkDrag
                [cdkDragData]="groupContact">
                
                <div class="d-flex align-items-center">
                  <img 
                    [src]="groupContact.imageUrl" 
                    [alt]="groupContact.name"
                    class="rounded me-2"
                    style="width: 40px; height: 40px; object-fit: cover;">
                  <span>{{ groupContact.name }}</span>
                </div>
                
                <button 
                  type="button" 
                  class="btn btn-sm btn-danger"
                  (click)="removeFromGroup(groupContact)"
                  title="Remove from group">
                  Ã—
                </button>
              </div>
            </div>
          </div>
          
          <div class="d-flex gap-2">
            <button 
              type="submit" 
              class="btn btn-success"
              [disabled]="!contactForm.valid">
              Save
            </button>
            <button 
              type="button" 
              class="btn btn-secondary"
              (click)="onCancel()">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <div class="col-md-5">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">Available Contacts</h5>
      </div>
      <div class="card-body">
        <div 
          class="contact-list"
          cdkDropList
          id="available-contacts"
          [cdkDropListData]="availableContacts"
          [cdkDropListConnectedTo]="['group-contacts']"
          (cdkDropListDropped)="onDrop($event)">
          
          <div 
            *ngFor="let contact of availableContacts"
            class="contact-item d-flex align-items-center border rounded p-2 mb-2 bg-white"
            cdkDrag
            [cdkDragData]="contact"
            style="cursor: move;">
            
            <img 
              [src]="contact.imageUrl" 
              [alt]="contact.name"
              class="rounded me-2"
              style="width: 40px; height: 40px; object-fit: cover;">
            <div>
              <div class="fw-bold">{{ contact.name }}</div>
              <small class="text-muted">{{ contact.email }}</small>
            </div>
          </div>
          
          <div *ngIf="availableContacts.length === 0" class="text-muted text-center py-3">
            No available contacts
          </div>
        </div>
      </div>
    </div>
  </div>
</div>